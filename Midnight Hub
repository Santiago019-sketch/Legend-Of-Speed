-- Load Rayfield UI Library
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

-- Create Window
local Window = Rayfield:CreateWindow({
   Name = "Midnight Hub",
   LoadingTitle = "Midnight Hub",
   LoadingSubtitle = "by Midnight Team",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "MidnightHub",
      FileName = "Config"
   },
   KeySystem = false
})

-- Create Tabs
local MainTab = Window:CreateTab("Main", 4483345998)
local AutoTab = Window:CreateTab("Auto", 4483345998)
local MiscTab = Window:CreateTab("Misc", 4483345998)

-- Main Features
MainTab:CreateSlider({
   Name = "WalkSpeed",
   Range = {16, 500},
   Increment = 1,
   CurrentValue = 16,
   Callback = function(Value)
       game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = Value
   end,
})

MainTab:CreateSlider({
   Name = "JumpPower",
   Range = {50, 500},
   Increment = 1,
   CurrentValue = 50,
   Callback = function(Value)
       game.Players.LocalPlayer.Character.Humanoid.JumpPower = Value
   end,
})

-- Auto Farm Features
local function collectOrb(orbType, location)
    local args = {
        "collectOrb",
        orbType,
        location
    }
    game:GetService("ReplicatedStorage").rEvents.orbEvent:FireServer(unpack(args))
end

AutoTab:CreateToggle({
    Name = "Auto Collect All Orbs",
    CurrentValue = false,
    Callback = function(Value)
        getgenv().AutoCollectOrbs = Value
        while wait(0.1) and getgenv().AutoCollectOrbs do
            pcall(function()
                local orbTypes = {"Yellow Orb", "Orange Orb", "Red Orb", "Blue Orb"}
                local locations = {"City", "Desert", "Magma City"}
                
                for _, location in ipairs(locations) do
                    for _, orbType in ipairs(orbTypes) do
                        collectOrb(orbType, location)
                    end
                end
            end)
        end
    end,
})

AutoTab:CreateToggle({
    Name = "Auto Collect Gems",
    CurrentValue = false,
    Callback = function(Value)
        getgenv().AutoCollectGems = Value
        spawn(function()
            while wait(0.1) and getgenv().AutoCollectGems do
                pcall(function()
                    local locations = {"City", "Desert", "Magma City"}
                    for _, location in ipairs(locations) do
                        collectOrb("Gem", location)
                    end
                end)
            end
        end)
    end,
})

AutoTab:CreateToggle({
    Name = "Fast Hoops Farm",
    CurrentValue = false,
    Callback = function(Value)
        getgenv().FastHoopsFarm = Value
        while wait() and getgenv().FastHoopsFarm do
            pcall(function()
                for _, hoop in pairs(game:GetService("Workspace").Hoops:GetChildren()) do
                    hoop.CFrame = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
                end
            end)
        end
    end,
})

AutoTab:CreateToggle({
    Name = "Safe Hoops Farm",
    CurrentValue = false,
    Callback = function(Value)
        getgenv().SafeHoopsFarm = Value
        spawn(function()
            while wait(0.3) and getgenv().SafeHoopsFarm do
                pcall(function()
                    for _, hoop in pairs(game:GetService("Workspace").Hoops:GetChildren()) do
                        hoop.CFrame = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
                        wait(0.3)
                    end
                end)
            end
        end)
    end,
})

AutoTab:CreateToggle({
    Name = "Auto Rebirth",
    CurrentValue = false,
    Callback = function(Value)
        getgenv().AutoRebirth = Value
        spawn(function()
            while wait(0.5) and getgenv().AutoRebirth do
                pcall(function()
                    game:GetService("ReplicatedStorage").rEvents.rebirthEvent:FireServer("rebirthRequest")
                end)
            end
        end)
    end,
})

AutoTab:CreateButton({
    Name = "Collect All Chests",
    Callback = function()
        local chestTypes = {
            {"groupRewards"},
            {"Enchanted Chest"},
            {workspace.rewardChests.rewardChest}
        }
        
        for _, chest in ipairs(chestTypes) do
            pcall(function()
                if chest[1] == "groupRewards" then
                    game:GetService("ReplicatedStorage").rEvents.groupRemote:InvokeServer(unpack(chest))
                elseif chest[1] == "Enchanted Chest" then
                    game:GetService("ReplicatedStorage").rEvents.checkChestRemote:InvokeServer(unpack(chest))
                else
                    game:GetService("ReplicatedStorage").rEvents.collectCourseChestRemote:InvokeServer(unpack(chest))
                end
            end)
            wait(0.1)
        end
    end,
})

-- Misc Features
MiscTab:CreateButton({
    Name = "Join Discord",
    Callback = function()
        setclipboard("https://discord.gg/midnight-hub")
        local req = (syn and syn.request) or (http and http.request) or http_request
        if req then
            req({
                Url = 'http://127.0.0.1:6463/rpc?v=1',
                Method = 'POST',
                Headers = {
                    ['Content-Type'] = 'application/json',
                    Origin = 'https://discord.com'
                },
                Body = game:GetService('HttpService'):JSONEncode({
                    cmd = 'INVITE_BROWSER',
                    nonce = game:GetService('HttpService'):GenerateGUID(false),
                    args = {code = 'midnight-hub'}
                })
            })
        end
    end,
})

MiscTab:CreateButton({
    Name = "Destroy GUI",
    Callback = function()
        Rayfield:Destroy()
    end,
})

MiscTab:CreateButton({
    Name = "Rejoin Game",
    Callback = function()
        game:GetService("TeleportService"):Teleport(game.PlaceId, game:GetService("Players").LocalPlayer)
    end,
})

-- Set toggle key bind
Rayfield:BindToClose(Enum.KeyCode.RightControl)
