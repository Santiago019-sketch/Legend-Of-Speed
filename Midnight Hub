-- Load Rayfield Library
local Rayfield = loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Rayfield/main/source"))()
if not Rayfield then
    warn("Failed to load Rayfield Library.")
    return
end

-- Create the GUI window
local Window = Rayfield:CreateWindow({
    Name = "Farming GUI",
    LoadingTitle = "Loading Farming GUI",
    LoadingSubtitle = "By YourNameHere",
    ConfigurationSaving = { Enabled = false }, -- Disable if not saving configuration
    KeySystem = false, -- Disable key system
})

-- Create Farming Tab and Section
local MainTab = Window:CreateTab("Farming", 4483362458) -- Replace with desired icon ID
local FarmingSection = MainTab:CreateSection("Orb Farming")

-- Variables to control toggles
local isYellowOrbFarming = false
local isRedOrbFarming = false

-- Function to handle farming orbs
local function farmOrbs(orbType, location, count)
    for i = 1, count do
        local success, err = pcall(function()
            game:GetService('ReplicatedStorage').rEvents.orbEvent:FireServer("collectOrb", orbType, location)
        end)
        if not success then
            warn("Error firing event for " .. orbType .. ": " .. err)
        end
        wait(0.3) -- Prevent spamming requests
    end
end

-- Create Orb Farm Toggles
FarmingSection:CreateToggle({
    Name = "Yellow Orb Farm",
    CurrentValue = false,
    Callback = function(state)
        isYellowOrbFarming = state
        spawn(function()
            while isYellowOrbFarming do
                farmOrbs("Yellow Orb", "City", 15)
                wait(1) -- Add delay to prevent potential overload
            end
        end)
    end,
})

FarmingSection:CreateToggle({
    Name = "Red Desert Orb Farm",
    CurrentValue = false,
    Callback = function(state)
        isRedOrbFarming = state
        spawn(function()
            while isRedOrbFarming do
                farmOrbs("Red Orb", "Desert", 7)
                wait(1) -- Add delay to prevent potential overload
            end
        end)
    end,
})

-- Create Farm Buttons
FarmingSection:CreateButton({
    Name = "Farm Steps (7500x)",
    Callback = function()
        farmOrbs("Red Orb", "City", 7500)
    end,
})

FarmingSection:CreateButton({
    Name = "Farm Gems (1000x)",
    Callback = function()
        farmOrbs("Gem", "City", 1000)
    end,
})
